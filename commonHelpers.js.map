{"version":3,"file":"commonHelpers.js","sources":["../src/index.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst elements = {\n  searchForm: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  btnLoadMore: document.querySelector('.load-more'),\n};\n\nelements.btnLoadMore.classList.add('is-hidden');\n\nelements.searchForm.addEventListener('submit', handlerSubmit);\nelements.btnLoadMore.addEventListener('click', onClickLoadMore);\n\nlet newSearchQuery = '';\nlet lightbox = new SimpleLightbox('.gallery a');\nlet page = 1;\nconst perPage = 40;\n\nasync function handlerSubmit(evt) {\n  evt.preventDefault();\n  elements.btnLoadMore.classList.add('is-hidden');\n  const form = evt.currentTarget;\n  newSearchQuery = form.searchQuery.value.trim();\n  if (newSearchQuery === '') {\n    iziToast.info({\n      message: 'Please write something...',\n      position: 'topRight',\n      color: 'rgba(57, 58, 58, 0.959);',\n    });\n    return;\n  }\n\n  elements.gallery.innerHTML = '';\n  elements.searchForm.reset();\n  page = 1;\n\n  try {\n    const { hits, totalHits } = await apiService(newSearchQuery, page, perPage);\n    if (totalHits === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query.Please try again.',\n        position: 'topRight',\n      });\n\n      elements.searchForm.reset();\n      elements.btnLoadMore.classList.add('is-hidden');\n      elements.gallery.innerHTML = '';\n\n      return;\n    }\n\n    elements.gallery.innerHTML = '';\n    if (totalHits < perPage) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'bottomCenter',\n        color: 'rgba(57, 58, 58, 0.959);',\n      });\n    }\n    if (totalHits > perPage) {\n      elements.btnLoadMore.classList.remove('is-hidden');\n    }\n    elements.gallery.innerHTML = '';\n    galleryMarkup(hits);\n    lightbox.refresh();\n    iziToast.success({\n      message: `Hooray! We found ${totalHits} images !!!`,\n      position: 'topRight',\n      color: 'hsl(26, 83%, 56%)',\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '38012427-abdef302c1869514a7af9c6c2';\n\nasync function apiService(newSearchQuery, page, perPage) {\n  const { data } = await axios.get(\n    `?key=${API_KEY}&q=${newSearchQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  );\n  return data;\n}\n\nfunction galleryMarkup(arr) {\n  let markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-item list\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"img-item\" src=\"${webformatURL}\" alt=\"${tags}\" width=600px />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b class=\"accent\">likes:</b>${likes}</p>\n          <p class=\"info-item\"><b class=\"accent\">views:</b>${views}</p>\n          <p class=\"info-item\"><b class=\"accent\">comments:</b>${comments}</p>\n          <p class=\"info-item\"><b class=\"accent\">downloads:</b>${downloads}</p>\n        </div>\n      </li>`;\n      }\n    )\n    .join('');\n  elements.gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nasync function onClickLoadMore() {\n  page += 1;\n  try {\n    const { hits, totalHits } = await apiService(newSearchQuery, page, perPage);\n    galleryMarkup(hits);\n    lightbox.refresh();\n    const totalPages = Math.ceil(totalHits / perPage);\n    if (page === totalPages) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'bottomCenter',\n        color: 'rgba(57, 58, 58, 0.959);',\n      });\n      elements.btnLoadMore.classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n"],"names":["elements","handlerSubmit","onClickLoadMore","newSearchQuery","lightbox","SimpleLightbox","page","perPage","evt","iziToast","hits","totalHits","apiService","galleryMarkup","error","axios","API_KEY","data","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","totalPages"],"mappings":"owBAMA,MAAMA,EAAW,CACf,WAAY,SAAS,cAAc,cAAc,EACjD,QAAS,SAAS,cAAc,UAAU,EAC1C,YAAa,SAAS,cAAc,YAAY,CAClD,EAEAA,EAAS,YAAY,UAAU,IAAI,WAAW,EAE9CA,EAAS,WAAW,iBAAiB,SAAUC,CAAa,EAC5DD,EAAS,YAAY,iBAAiB,QAASE,CAAe,EAE9D,IAAIC,EAAiB,GACjBC,EAAW,IAAIC,EAAe,YAAY,EAC1CC,EAAO,EACX,MAAMC,EAAU,GAEhB,eAAeN,EAAcO,EAAK,CAKhC,GAJAA,EAAI,eAAc,EAClBR,EAAS,YAAY,UAAU,IAAI,WAAW,EAE9CG,EADaK,EAAI,cACK,YAAY,MAAM,KAAI,EACxCL,IAAmB,GAAI,CACzBM,EAAS,KAAK,CACZ,QAAS,4BACT,SAAU,WACV,MAAO,0BACb,CAAK,EACD,MACD,CAEDT,EAAS,QAAQ,UAAY,GAC7BA,EAAS,WAAW,QACpBM,EAAO,EAEP,GAAI,CACF,KAAM,CAAE,KAAAI,EAAM,UAAAC,GAAc,MAAMC,EAAWT,EAAgBG,EAAMC,CAAO,EAC1E,GAAII,IAAc,EAAG,CACnBF,EAAS,MAAM,CACb,QACE,0EACF,SAAU,UAClB,CAAO,EAEDT,EAAS,WAAW,QACpBA,EAAS,YAAY,UAAU,IAAI,WAAW,EAC9CA,EAAS,QAAQ,UAAY,GAE7B,MACD,CAEDA,EAAS,QAAQ,UAAY,GACzBW,EAAYJ,GACdE,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,eACV,MAAO,0BACf,CAAO,EAECE,EAAYJ,GACdP,EAAS,YAAY,UAAU,OAAO,WAAW,EAEnDA,EAAS,QAAQ,UAAY,GAC7Ba,EAAcH,CAAI,EAClBN,EAAS,QAAO,EAChBK,EAAS,QAAQ,CACf,QAAS,oBAAoBE,eAC7B,SAAU,WACV,MAAO,mBACb,CAAK,CACF,OAAQG,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH,CACAC,EAAM,SAAS,QAAU,2BACzB,MAAMC,EAAU,qCAEhB,eAAeJ,EAAWT,EAAgBG,EAAMC,EAAS,CACvD,KAAM,CAAE,KAAAU,CAAI,EAAK,MAAMF,EAAM,IAC3B,QAAQC,OAAab,kEAA+EG,cAAiBC,GACzH,EACE,OAAOU,CACT,CAEA,SAASJ,EAAcK,EAAK,CAC1B,IAAIC,EAASD,EACV,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA,mBACIL;AAAA,uCACoBD,WAAsBE;AAAA;AAAA;AAAA,6DAGAC;AAAA,6DACAC;AAAA,gEACGC;AAAA,iEACCC;AAAA;AAAA,YAI5D,EACA,KAAK,EAAE,EACV1B,EAAS,QAAQ,mBAAmB,YAAamB,CAAM,CACzD,CAEA,eAAejB,GAAkB,CAC/BI,GAAQ,EACR,GAAI,CACF,KAAM,CAAE,KAAAI,EAAM,UAAAC,GAAc,MAAMC,EAAWT,EAAgBG,EAAMC,CAAO,EAC1EM,EAAcH,CAAI,EAClBN,EAAS,QAAO,EAChB,MAAMuB,EAAa,KAAK,KAAKhB,EAAYJ,CAAO,EAC5CD,IAASqB,IACXlB,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,eACV,MAAO,0BACf,CAAO,EACDT,EAAS,YAAY,UAAU,IAAI,WAAW,EAEjD,OAAQc,EAAP,CACA,QAAQ,IAAIA,CAAK,CAClB,CACH"}